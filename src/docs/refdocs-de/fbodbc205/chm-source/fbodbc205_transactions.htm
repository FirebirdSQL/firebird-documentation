<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="alink name" value="$topicid_Fbodbc205-transactions"></object>
<script type="text/javascript" src="helpman_topicinit.js"></script>

   <title>Transactions</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">Transactions</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="fbodbc205.htm">Top</a>&nbsp;
     <a href="fbodbc205_threading.htm">Previous</a>&nbsp;
     <a href="fbodbc205_password.htm">Next</a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 24px;"><table cellspacing="2" cellpadding="1" border="0" style="border: none; border-spacing:2px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="middle" bgcolor="#f0f0f0" style="background-color:#f0f0f0;"><p><span style="font-family: 'Verdana'; color: ;">Firebird Documentation Index</span><span style="font-family: 'Verdana'; color: #000000;"> &#8594; <a href="fbodbc205.htm">Firebird ODBC/JDBC Driver Manual</a> &#8594; <a href="fbodbc205_using.htm">Developing with the Firebird ODBC/JDBC Driver</a> &#8594; Transactions</span></p>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="top"><br>
</td>
</tr>
</table>
</div>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-transactions"></a><span style="font-size: 14pt; font-family: 'Verdana'; font-weight: bold; color: #000000;">Transactions</span></p>
<p style="margin: 0px 0px 0px 24px;"><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">Table of Contents</span></p>
<p style="text-indent: -13px; margin: 0px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;"><a href="fbodbc205_transactions.htm#fbodbc205-locking">Locking</a></span></p>
<p style="text-indent: -13px; margin: 0px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;"><a href="fbodbc205_transactions.htm#fbodbc205-tx-request">Transaction Request Syntax</a></span></p>
<p style="text-indent: -13px; margin: 0px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;"><a href="fbodbc205_transactions.htm#fbodbc205-tx-2-phase">Two Phase Commit Transactions</a></span></p>
<p style="text-indent: -13px; margin: 0px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;"><a href="fbodbc205_transactions.htm#fbodbc205-multi-tx">More Transactions</a></span></p>
<p style="text-indent: -13px; margin: 0px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;"><a href="fbodbc205_transactions.htm#fbodbc205-tx-ms-dtc">MS DTC Transactions</a></span></p>
<p style="margin: 48px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">Firebird supports three transaction isolation levels:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 46px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Symbol'; font-style: normal; color: #000000; text-decoration: none;">&#183;</span></td><td><span style="font-family: 'Verdana'; color: #000000;">READ COMMITTED</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 46px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Symbol'; font-style: normal; color: #000000; text-decoration: none;">&#183;</span></td><td><span style="font-family: 'Verdana'; color: #000000;">SNAPSHOT (“</span><span style="font-family: 'Verdana'; color: #000000;">concurrency</span><span style="font-family: 'Verdana'; color: #000000;">” or “</span><span style="font-family: 'Verdana'; color: #000000;">repeatable read</span><span style="font-family: 'Verdana'; color: #000000;">”)</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 46px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="13"><span style="font-size: 10pt; font-family: 'Symbol'; font-style: normal; color: #000000; text-decoration: none;">&#183;</span></td><td><span style="font-family: 'Verdana'; color: #000000;">SNAPSHOT TABLE STABILITY “</span><span style="font-family: 'Verdana'; color: #000000;">consistency</span><span style="font-family: 'Verdana'; color: #000000;">”)</span></td></tr></table></div><p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">The default isolation level of the ODBC/JDBC driver is READ COMMITTED, which maps with read committed in other database systems. Firebird's other isolation levels do not map so easily. In the ODBC/JDBC driver, SNAPSHOT maps to REPEATABLE READ and SNAPSHOT TABLE STABILITY maps to SERIALIZABLE, with some tweaks.</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">Since v.2.0, the driver has been able to support every transaction configuration that Firebird can support, including table reservation (“</span><span style="font-family: 'Verdana'; color: #000000;">table blocking</span><span style="font-family: 'Verdana'; color: #000000;">”). That was achieved by incorporating the so-called “</span><span style="font-family: 'Verdana'; color: #000000;">EmbeddedSQL</span><span style="font-family: 'Verdana'; color: #000000;">” syntax that is native to the old pre-compiler, </span><span style="font-family: 'Verdana'; font-style: italic; color: #000000;">gpre</span><span style="font-family: 'Verdana'; color: #000000;">, to prepare calls to the ODBC API by the function </span><span style="font-size: 8pt; font-family: 'Courier New'; color: #000000;">SQLExecDirect</span><span style="font-family: 'Verdana'; color: #000000;">.</span></p>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-locking"></a><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">Locking</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">Firebird implements optimistic row-level locking under all conditions. A transaction does not attempt to lock a record until it is ready to post an update operation affecting that record. It can happen, though rarely, for an update to fail because another client has a lock on the record, even if the transaction that fails started before the one that secured the lock.</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">Firebird's record versioning engine is able to achieve a granularity finer than that provided by traditional row-level locking. Versioning allows any number of transactions to read a consistent copy of any given record, even if other transactions are updating the same row simultaneously. Readers and writers never block one another and Firebird's maintenance of record versions is totally transparent to the user.</span></p>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-tx-request"></a><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">Transaction Request Syntax</span></p>
<p style="margin: 0px 0px 0px 24px;"><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">Table of Contents</span></p>
<p style="text-indent: -13px; margin: 0px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;"><a href="fbodbc205_transactions.htm#fbodbc205-tx-options">What the Options Mean</a></span></p>
<p style="margin: 48px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">The syntax for an ODBC-friendly transaction request follows.</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">SET&nbsp;|&nbsp;DECLARE&nbsp;TRANSACTION&nbsp;[LOCAL]&nbsp;[NAME&nbsp;&lt;transaction-name&gt;&nbsp;[USING&nbsp;&lt;namedUniqueWorkspace&gt;]]</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">[READ&nbsp;WRITE&nbsp;|&nbsp;READ&nbsp;ONLY]</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">[WAIT&nbsp;|&nbsp;NO&nbsp;WAIT]</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">[AUTOCOMMIT]</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">[NO_AUTO_UNDO]</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">[[ISOLATION&nbsp;LEVEL]&nbsp;{SNAPSHOT&nbsp;[TABLE&nbsp;STABILITY]&nbsp;or&nbsp;REPEATABLE&nbsp;READ</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">|&nbsp;SERIALIZABLE</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">|&nbsp;READ&nbsp;COMMITTED&nbsp;[[NO]&nbsp;RECORD_VERSION]}]</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">[RESERVING&nbsp;&lt;table-name-1&gt;&nbsp;[,&nbsp;&lt;table-name-2&gt;[,&nbsp;...&lt;table-name-n&gt;]&nbsp;]</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">[FOR&nbsp;[SHARED&nbsp;|&nbsp;PROTECTED]&nbsp;{READ&nbsp;|&nbsp;WRITE}]&nbsp;[,&nbsp;]</span></p>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-tx-options"></a><span style="font-family: 'Verdana'; font-style: italic; font-weight: bold; color: #000000;">What the Options Mean</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">DECLARE TRANSACTION...</span><span style="font-family: 'Verdana'; color: #000000;"> declares the described transaction, without activating it. </span><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">SET TRANSACTION...</span><span style="font-family: 'Verdana'; color: #000000;">, on the other hand, activates the transaction, temporarily switching the SQL_ATTR_AUTOCOMMIT global attribute of the ODBC API to SQL_AUTOCOMMIT_OFF. The transaction will have to be finished explicitly; when it ends, the abiding rule of the API resumes.</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">LOCAL</span><span style="font-family: 'Verdana'; color: #000000;"> limits a transaction to acting only within the context of the current connection.</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">NAME &lt;transaction-name&gt;</span><span style="font-family: 'Verdana'; color: #000000;"> is a uniquely-named transaction, prepared for use by any connections in the global environment.</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">USING &lt;namedUniqueWorkspace&gt;</span><span style="font-family: 'Verdana'; color: #000000;"> is a uniquely-named transaction workspace in which </span><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">NAME &lt;transaction-name&gt;</span><span style="font-family: 'Verdana'; color: #000000;"> can be set to run by any connections in the global environment. Identically named transactions with differing parameters can run in the same named workspace.</span></p>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-tx-named"></a><span style="font-size: 9pt; font-family: 'Verdana'; font-weight: bold; color: #000000;">Named Transactions and Transaction Workspaces</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">The construct </span><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">DECLARE TRANSACTION ... NAME &lt;transaction-name&gt; [USING &lt;namedUniqueWorkspace&gt;]</span><span style="font-family: 'Verdana'; color: #000000;"> allows explicit transactions to be configured and saved into the global environment in preparation for repeated use for any connection request or by any active connection. An instance of the saved transaction can be called into action by a specific form of the </span><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">SET TRANSACTION</span><span style="font-family: 'Verdana'; color: #000000;"> command:</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">For a connection request:</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">SET&nbsp;TRANSACTION&nbsp;NAME&nbsp;MyReadTransaction</span></p>
<p style="margin: 24px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">or</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">SET&nbsp;TRANSACTION&nbsp;NAME&nbsp;MyReadTransaction&nbsp;USING&nbsp;MyDsnDb1</span></p>
<p style="margin: 24px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">for separate requests within a single active connection:</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">SET&nbsp;TRANSACTION&nbsp;LOCAL&nbsp;NAME&nbsp;MyReadTransaction</span></p>
<p style="margin: 24px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">or</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">SET&nbsp;TRANSACTION&nbsp;LOCAL&nbsp;NAME&nbsp;MyReadTransaction&nbsp;USING&nbsp;MyDsnDb1</span></p>
<p style="margin: 24px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">and, in this connection, for another request:</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">SET&nbsp;TRANSACTION&nbsp;LOCAL&nbsp;NAME&nbsp;MyWriteTransaction</span></p>
<p style="margin: 24px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">or</span></p>
<p style="white-space: nowrap; border-color: #000000; border-style: solid; border-width: 1px; background: #fffff7; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span style="font-family: 'Courier New'; color: #000000;">SET&nbsp;TRANSACTION&nbsp;LOCAL&nbsp;NAME&nbsp;MyWriteTransaction&nbsp;USING&nbsp;MyDsnDb1</span></p>
<p style="margin: 24px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">The form </span><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">SET TRANSACTION ... NAME &lt;transaction-name&gt; [USING &lt;namedUniqueWorkspace&gt;]</span><span style="font-family: 'Verdana'; color: #000000;"> differs from earlier implementations whereby the configuration set by the </span><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">SET</span><span style="font-family: 'Verdana'; color: #000000;"> command would be repeated for the next transaction. The inclusion of the NAME and/or USING clauses makes the configuration repeatable on demand by use of the name.</span></p>
<p style="margin: 19px 0px 0px 65px;"><span style="font-family: 'Verdana'; font-weight: bold; color: #ff0000;">Important</span></p>
<p style="margin: 19px 0px 0px 65px;"><span style="font-size: 8pt; font-family: 'Verdana'; color: #000000;">A return to the usual mode of operation requires a detach/connect cycle.</span></p>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-txns-finishing"></a><span style="font-size: 9pt; font-family: 'Verdana'; font-weight: bold; color: #000000;">Ending Explicit Transactions</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">In SQL, a transaction is completed by a </span><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">COMMIT</span><span style="font-family: 'Verdana'; color: #000000;"> or </span><span style="font-size: 9pt; font-family: 'Verdana'; color: #000000;">ROLLBACK</span><span style="font-family: 'Verdana'; color: #000000;"> request. ODBC has methods that do one or the other, such as </span><span style="font-size: 8pt; font-family: 'Courier New'; color: #000000;">SQLEndTran</span><span style="font-family: 'Verdana'; color: #000000;">. Some programs are able to invoke </span><span style="font-size: 8pt; font-family: 'Courier New'; color: #000000;">SQLExecDirect</span><span style="font-family: 'Verdana'; color: #000000;"> but cannot call </span><span style="font-size: 8pt; font-family: 'Courier New'; color: #000000;">SQLEndTran</span><span style="font-family: 'Verdana'; color: #000000;">. For those programs it is necessary to call an explicit</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">SQLExecDirect(&nbsp;hStmt,&nbsp;&quot;COMMIT&quot;&nbsp;)</span></p>
<p style="margin: 24px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">to ensure that the interface will call</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">SQLEndTran(&nbsp;SQL_HANDLE_DBC,&nbsp;hConnection,&nbsp;SQL_COMMIT&nbsp;);</span></p>
<p style="margin: 19px 0px 0px 65px;"><span style="font-family: 'Verdana'; font-weight: bold; color: #0000ff;">Note</span></p>
<p style="margin: 19px 0px 0px 65px;"><span style="font-size: 8pt; font-family: 'Verdana'; color: #000000;">If a transaction is initiated locally, the driver will execute </span><span style="font-size: 7pt; font-family: 'Courier New'; color: #000000;">SQLEndTran</span><span style="font-size: 8pt; font-family: 'Verdana'; color: #000000;"> for the local </span><span style="font-size: 7pt; font-family: 'Courier New'; color: #000000;">hStmt</span><span style="font-size: 8pt; font-family: 'Verdana'; color: #000000;">.</span></p>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-tx-2-phase"></a><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">Two Phase Commit Transactions</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">The ODBC/JDBC driver supports two-phase commit transactions, that is, a single transaction across different Firebird databases. Up to 16 databases can be accessed simultaneously in one such transaction—that is an absolute limit.</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">The call to start a two-phase commit transaction is:</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">SQLSetConnectAttr&nbsp;(connection,&nbsp;4000,&nbsp;(void*)&nbsp;TRUE,&nbsp;0);</span></p>
<p style="margin: 24px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">To cancel the common connection:</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">SQLSetConnectAttr&nbsp;(connection,&nbsp;4000,&nbsp;(void*)&nbsp;FALSE,&nbsp;0);</span></p>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-multi-tx"></a><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">More Transactions</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">Firebird ODBC by default uses one transaction per connection. Programatically you can use a more flexible transaction stucture. For example you can use multiple transactions within one connection, whereby a single connection can be using a number of read/write transactions simultaneously.</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">An Example</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;HSTMT&nbsp;stmtRd;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;HSTMT&nbsp;stmtWr;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLAllocHandle(&nbsp;SQL_HANDLE_STMT,&nbsp;connection,&nbsp;&amp;stmtRd&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLAllocHandle(&nbsp;SQL_HANDLE_STMT,&nbsp;connection,&nbsp;&amp;stmtWr&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLExecDirect(&nbsp;stmtRd,&nbsp;(UCHAR*)</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;SET&nbsp;TRANSACTION&nbsp;LOCAL\n&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;READ&nbsp;ONLY\n&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ISOLATION&nbsp;LEVEL\n&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;READ&nbsp;COMMITTED&nbsp;NO&nbsp;RECORD_VERSION&nbsp;WAIT\n&quot;,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL_NTS&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLExecDirect(&nbsp;stmtWr,&nbsp;(UCHAR*)</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;SET&nbsp;TRANSACTION&nbsp;LOCAL\n&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;READ&nbsp;WRITE\n&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ISOLATION&nbsp;LEVEL\n&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;READ&nbsp;COMMITTED&nbsp;NO&nbsp;RECORD_VERSION&nbsp;WAIT\n&quot;,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL_NTS&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLExecDirect(&nbsp;stmtRd,(UCHAR*)</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;SELECT&nbsp;CURRENCY&nbsp;FROM&nbsp;COUNTRY&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;&nbsp;&nbsp;WHERE&nbsp;country&nbsp;=&nbsp;'Canada'&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;&nbsp;&nbsp;FOR&nbsp;UPDATE&nbsp;OF&nbsp;CURRENCY&quot;,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL_NTS&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLFetch(&nbsp;stmtRd&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLPrepare(&nbsp;stmtWr,&nbsp;(UCHAR*)</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&quot;update&nbsp;COUNTRY\n&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&quot;set&nbsp;&nbsp;&nbsp;&nbsp;CURRENCY&nbsp;=&nbsp;'CndDlr'\n&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&quot;where&nbsp;&nbsp;COUNTRY&nbsp;=&nbsp;'Canada'\n&quot;,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;SQL_NTS&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLExecute(&nbsp;stmtWr&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLExecDirect(&nbsp;stmtWr,&nbsp;(UCHAR*)&quot;COMMIT&quot;,&nbsp;SQL_NTS&nbsp;);</span></p>
<p style="margin: 19px 0px 19px 24px;"><a name="fbodbc205-tx-ms-dtc"></a><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">MS DTC Transactions</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; color: #000000;">The Microsoft Distributed Transaction Coordinator (MS DTC) service is a Windows component that is responsible for coordinating transactions that span multiple resource managers, such as database systems, message queues, and file systems. It can perform global, single-phase or two-phase commit transactions involving MSSQL Server, Sybase and other servers that are able to to work with it. Our ODBC/JDBC driver provides that capability for Firebird servers.</span></p>
<p style="margin: 14px 0px 0px 24px;"><span style="font-family: 'Verdana'; font-weight: bold; color: #000000;">An Example Using MS DTC</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">//&nbsp;Include&nbsp;MS&nbsp;DTC&nbsp;specific&nbsp;header&nbsp;files.</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">//------------------------------------------------------------------------------</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">#define&nbsp;INITGUID</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">#include&nbsp;&quot;txdtc.h&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">#include&nbsp;&quot;xolehlp.h&quot;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;ITransactionDispenser&nbsp;*pTransactionDispenser;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;ITransaction&nbsp;*pTransaction;</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Obtain&nbsp;the&nbsp;ITransactionDispenser&nbsp;Interface&nbsp;pointer</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;by&nbsp;calling&nbsp;DtcGetTransactionManager()</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;DtcGetTransactionManager(&nbsp;NULL,//&nbsp;[in]&nbsp;LPTSTR&nbsp;pszHost,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,//&nbsp;[in]&nbsp;LPTSTR&nbsp;pszTmName,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IID_ITransactionDispenser,//&nbsp;[in]&nbsp;REFIID&nbsp;rid,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,//&nbsp;[in]&nbsp;DWORDdwReserved1,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;//&nbsp;[in]&nbsp;WORDwcbReserved2,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,//&nbsp;[in]&nbsp;void&nbsp;FAR&nbsp;*&nbsp;pvReserved2,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(void&nbsp;**)&amp;pTransactionDispenser&nbsp;//&nbsp;[out]&nbsp;void**&nbsp;ppvObject</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Establish&nbsp;connection&nbsp;to&nbsp;database&nbsp;on&nbsp;server#1</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;LogonToDB(&nbsp;&amp;gSrv1&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Establish&nbsp;connection&nbsp;to&nbsp;database&nbsp;on&nbsp;server#2</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;LogonToDB(&nbsp;&amp;gSrv2&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Initiate&nbsp;an&nbsp;MS&nbsp;DTC&nbsp;transaction</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;pTransactionDispenser-&gt;BeginTransaction(</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,//&nbsp;[in]&nbsp;IUnknown&nbsp;__RPC_FAR&nbsp;*punkOuter,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISOLATIONLEVEL_ISOLATED,//&nbsp;[in]&nbsp;ISOLEVEL&nbsp;isoLevel,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ISOFLAG_RETAIN_DONTCARE,//&nbsp;[in]&nbsp;ULONG&nbsp;isoFlags,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,//&nbsp;[in]&nbsp;ITransactionOptions&nbsp;*pOptions</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;pTransaction//&nbsp;[out]&nbsp;ITransaction&nbsp;**ppTransaction</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Enlist&nbsp;each&nbsp;of&nbsp;the&nbsp;data&nbsp;sources&nbsp;in&nbsp;the&nbsp;transaction</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLSetConnectOption(&nbsp;gSrv1-&gt;hdbc,&nbsp;SQL_COPT_SS_ENLIST_IN_DTC,&nbsp;(UDWORD)pTransaction&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;SQLSetConnectOption(&nbsp;gSrv2-&gt;hdbc,&nbsp;SQL_COPT_SS_ENLIST_IN_DTC,&nbsp;(UDWORD)pTransaction&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Generate&nbsp;the&nbsp;SQL&nbsp;statement&nbsp;to&nbsp;execute&nbsp;on&nbsp;each&nbsp;of&nbsp;the&nbsp;databases</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;sprintf(&nbsp;SqlStatement,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;update&nbsp;authors&nbsp;set&nbsp;address&nbsp;=&nbsp;'%s_%d'&nbsp;where&nbsp;au_id&nbsp;=&nbsp;'%s'&quot;,</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gNewAddress,&nbsp;i,&nbsp;gAuthorID&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Perform&nbsp;updates&nbsp;on&nbsp;both&nbsp;of&nbsp;the&nbsp;DBs&nbsp;participating&nbsp;in&nbsp;the&nbsp;transaction</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;ExecuteStatement(&nbsp;&amp;gSrv1,&nbsp;SqlStatement&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;ExecuteStatement(&nbsp;&amp;gSrv2,&nbsp;SqlStatement&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Commit&nbsp;the&nbsp;transaction</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;hr&nbsp;=&nbsp;pTransaction-&gt;Commit(&nbsp;0,&nbsp;0,&nbsp;0&nbsp;);</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;or&nbsp;roll&nbsp;back&nbsp;the&nbsp;transaction</span></p>
<p class="p_programlisting" style="border-color: #000000; border-style: solid; border-width: 1px; padding: 1px 1px 1px 1px; margin: -1px -1px -1px 25px;"><span class="f_programlisting">&nbsp;&nbsp;&nbsp;&nbsp;//hr&nbsp;=&nbsp;pTransaction-&gt;Abort(&nbsp;0,&nbsp;0,&nbsp;0&nbsp;);</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 24px;"><table cellspacing="2" cellpadding="1" border="0" style="border: none; border-spacing:2px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="bottom" style="height:64px;"><p style="text-align: right;"><a href="fbodbc205_threading.htm"><img src="prev-or18.png" width="30" height="30" border="0" alt="prev-or18"></a><a href="fbodbc205.htm#book-toc"><img src="toc-or18.png" width="30" height="30" border="0" alt="toc-or18"></a><a href="fbodbc205_using.htm"><img src="top-or18.png" width="30" height="30" border="0" alt="top-or18"></a><a href="fbodbc205_password.htm"><img src="next-or18.png" width="30" height="30" border="0" alt="next-or18"></a></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 24px;"><table cellspacing="2" cellpadding="1" border="0" style="border: none; border-spacing:2px;">
<tr style="text-align:left;vertical-align:top;">
<td valign="top"><br>
</td>
</tr>
<tr style="text-align:left;vertical-align:top;">
<td valign="middle" bgcolor="#f0f0f0" style="background-color:#f0f0f0;"><p><span style="font-family: 'Verdana'; color: #000000;">Firebird Documentation Index &#8594; <a href="fbodbc205.htm">Firebird ODBC/JDBC Driver Manual</a> &#8594; <a href="fbodbc205_using.htm">Developing with the Firebird ODBC/JDBC Driver</a> &#8594; Transactions</span></p>
</td>
</tr>
</table>
</div>

</td></tr></table>

</body>
</html>
