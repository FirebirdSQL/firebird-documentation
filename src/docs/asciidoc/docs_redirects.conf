# Redirect configuration for www.firebirdsql.org
# These redirects are not only for Firebird documentation, but also for other broken, renamed or removed links

# Historic shortcuts
location /manual {
  rewrite ^/manual/?$ /en/documentation/ redirect;
  rewrite ^/manual/(.+)$ /file/documentation/reference_manuals/user_manuals/html/$1 last;
}
location /pdfmanual {
  rewrite ^/pdfmanual/?$ /en/documentation/ redirect;
  rewrite ^/pdfmanual/(.+)$ /file/documentation/reference_manuals/user_manuals/$1 last;
}
location /refdocs {
  rewrite ^/refdocs/?$ /en/reference-manuals/ redirect;
  rewrite ^/refdocs/(.+)$ /file/documentation/reference_manuals/reference_material/html/$1 last;
}
location /pdfrefdocs {
  rewrite ^/pdfrefdocs/?$ /en/reference-manuals/ redirect;
  rewrite ^/pdfrefdocs/(.+)$ /file/documentation/reference_manuals/reference_material/$1 last;
}
location /rlsnotes {
  rewrite ^/rlsnotes/?$ /en/release-notes/ redirect;
  rewrite ^/rlsnotes/(.+)$ /file/documentation/release_notes/$1 last;
}
location /rlsnotesh {
  rewrite ^/rlsnotesh/?$ /en/release-notes/ redirect;
  rewrite ^/rlsnotesh/(.+)$ /file/documentation/release_notes/html/$1 last;
}
location /devel/doc/ {
  rewrite ^/devel/doc/manual/html/(.*)$ /file/documentation/reference_manuals/user_manuals/html/$1 last;
  rewrite ^/devel/doc/manual/pdf/(.*)$ /file/documentation/reference_manuals/user_manuals/$1 last;
  rewrite ^/devel/doc/rlsnotes/html/(.*)$ /file/documentation/release_notes/html/$1 last;
  rewrite ^/devel/doc/rlsnotes/pdf/(.*)$ /file/documentation/release_notes/$1 last;
  rewrite ^/devel/doc/jaybird/pdf/jaybird_manual\.pdf$ https://firebirdsql.github.io/jaybird-manual/jaybird_manual.pdf permanent;
}
location = /download/drivers {
  return 302 /en/connectivity/;
}
location = /download/drivers/ {
  return 302 /en/connectivity/;
}
location = /download {
  return 302 /en/downloads/;
}
location = /download/ {
  return 302 /en/downloads/;
}

# Old docbook documentation
location /file/documentation/reference_manuals/ {
  # docbuildhowto - Firebird Docbuilding Howto redirects
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/docbuildhowto.*$ /file/documentation/html/en/firebirddocs/docbuildhowto/firebird-docbuilding-howto.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-Docbuilding-Howto\.pdf$ /file/documentation/pdf/en/firebirddocs/docbuildhowto/firebird-docbuilding-howto.pdf permanent;

  # docwritehowto - Firebird Docwriting Guide redirects
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/docwritehowto.*$ /file/documentation/html/en/firebirddocs/docwritehowto/firebird-docwriting-guide.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-Docwriting-Guide\.pdf$ /file/documentation/pdf/en/firebirddocs/docwritehowto/firebird-docwriting-guide.pdf permanent;

  # fbcache - Firebird Database Cache Buffer redirects
  rewrite ^/file/documentation/reference_manuals/(?:reference_material|user_manuals)/html/fbcache.*$ /file/documentation/html/en/firebirddocs/fbcache/firebird-cache.html permanent;
  rewrite ^/file/documentation/reference_manuals/(?:reference_material|user_manuals)/(?i)Firebird-Cache\.pdf$ /file/documentation/pdf/en/firebirddocs/fbcache/firebird-cache.pdf permanent;

  # fbcache de - Firebird Database Cache Buffer German redirects
  rewrite ^/file/documentation/reference_manuals/reference_material/html/de/fbcache.*$ /file/documentation/html/de/firebirddocs/fbcache/firebird-cache-de.html permanent;
  rewrite ^/file/documentation/reference_manuals/reference_material/(?i)Firebird-Cache-German\.pdf$ /file/documentation/pdf/de/firebirddocs/fbcache/firebird-cache-de.pdf permanent;

  # fblangref25 - Firebird 2.5 Language Reference redirects:
  rewrite ^/file/documentation/reference_manuals/fblangref25-en/html/fblangref.*$ /file/documentation/html/en/refdocs/fblangref25/firebird-25-language-reference.html permanent;
  rewrite ^/file/documentation/reference_manuals/fblangref25-en/(?i)Firebird_Language_Reference_25EN\.pdf$ /file/documentation/pdf/en/refdocs/fblangref25/firebird-25-language-reference.pdf permanent;

  # fblangref25-de - Firebird 2.5 Language Reference German (Firebird 2.5 Sprachreferenz) redirects:
  rewrite ^/file/documentation/reference_manuals/html/de/fblangref.*$ /file/documentation/html/de/refdocs/fblangref25/firebird-25-sprachreferenz.html permanent;
  rewrite ^/file/documentation/reference_manuals/(?i)firebird_referenz_dokumentation_v25\.pdf$ /file/documentation/pdf/de/refdocs/fblangref25/firebird-25-sprachreferenz.pdf permanent;

  # fbmgr - Firebird SuperServer Manager redirects:
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/fbmgr.*$ /file/documentation/html/en/firebirddocs/fbmgr/firebird-fbmgr.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/fbguard.*$ /file/documentation/html/en/firebirddocs/fbmgr/firebird-fbmgr.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-fbmgr\.pdf$ /file/documentation/pdf/en/firebirddocs/fbmgr/firebird-fbmgr.pdf permanent;

  # gbak - Firebird Backup & Restore Utility
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/gbak.*$ /file/documentation/html/en/firebirddocs/gbak/firebird-gbak.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-gbak\.pdf$ /file/documentation/pdf/en/firebirddocs/gbak/firebird-gbak.pdf permanent;

  # gsec - Firebird Password File Utility
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/(?:fbutils-)?gsec.*$ /file/documentation/html/en/firebirddocs/gsec/firebird-gsec.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-gsec\.pdf$ /file/documentation/pdf/en/firebirddocs/gsec/firebird-gsec.pdf permanent;

  # gfix - Firebird Database Housekeeping Utility
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/(?:fbutils-)?gfix.*$ /file/documentation/html/en/firebirddocs/gfix/firebird-gfix.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-gfix\.pdf$ /file/documentation/pdf/en/firebirddocs/gfix/firebird-gfix.pdf permanent;

  # gsplit - Firebird Backup File Splitting Filter
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/gsplit.*$ /file/documentation/html/en/firebirddocs/gsplit/firebird-gsplit.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-gsplit\.pdf$ /file/documentation/pdf/en/firebirddocs/gsplit/firebird-gsplit.pdf permanent;

  # gstat - Firebird Database Statistics Reporting Tool
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/gstat.*$ /file/documentation/html/en/firebirddocs/gstat/firebird-gstat.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/bk02ar17s03\.html$ /file/documentation/html/en/firebirddocs/gstat/firebird-gstat.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-gstat\.pdf$ /file/documentation/pdf/en/firebirddocs/gstat/firebird-gstat.pdf permanent;

  # isql - Firebird Interactive SQL Utility
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/isql.*$ /file/documentation/html/en/firebirddocs/isql/firebird-isql.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/bk0(?:1ar19s06|2ar08s06|2ar19s06)\.html$ /file/documentation/html/en/firebirddocs/isql/firebird-isql.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-isql\.pdf$ /file/documentation/pdf/en/firebirddocs/isql/firebird-isql.pdf permanent;

  # fb-shell-scripts - Firebird Shell Scripts
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/fb-shell-scripts.*$ /file/documentation/html/en/firebirddocs/fb-shell-scripts/firebird-shell-scripts.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/fbutils-scripts.*$ /file/documentation/html/en/firebirddocs/fb-shell-scripts/firebird-shell-scripts.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/fbscripts.*$ /file/documentation/html/en/firebirddocs/fb-shell-scripts/firebird-shell-scripts.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-shell-scripts\.pdf$ /file/documentation/pdf/en/firebirddocs/fb-shell-scripts/firebird-shell-scripts.pdf permanent;

  # fbdevgd30 - Firebird 3.0 Developer's Guide
  rewrite ^/file/documentation/reference_manuals/fbdevgd-en/html/fbdevgd.*$ /file/documentation/html/en/refdocs/fbdevgd30/firebird-30-developers-guide.html permanent;
  rewrite ^/file/documentation/reference_manuals/fbdevgd-en/html/fbdg.*$ /file/documentation/html/en/refdocs/fbdevgd30/firebird-30-developers-guide.html permanent;
  rewrite ^/file/documentation/reference_manuals/fbdevgd-en/(?i)Firebird_Devel_Guide_30EN\.pdf$ /file/documentation/pdf/en/refdocs/fbdevgd30/firebird-30-developers-guide.pdf permanent;
  # fbdevgd30 - Examples
  rewrite ^/file/documentation/reference_manuals/fblangref25-en/code/(.*)$ /file/documentation/examples/en/fbdevgd30/$1 permanent;

  # gsg3 - Firebird 3 Quick Start Guide
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/qsg3.*$ /file/documentation/html/en/firebirddocs/qsg3/firebird-3-quickstartguide.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-3-QuickStart\.pdf$ /file/documentation/pdf/en/firebirddocs/qsg3/firebird-3-quickstartguide.pdf permanent;

  # nbackup - Firebird's nbackup tool
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/nbackup.*$ /file/documentation/html/en/firebirddocs/nbackup/firebird-nbackup.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-nbackup\.pdf$ /file/documentation/pdf/en/firebirddocs/nbackup/firebird-nbackup.pdf permanent;

  # nbackup-de - Firebird's nbackup tool German
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/de/nbackup.*$ /file/documentation/html/de/firebirddocs/nbackup/firebird-nbackup-de.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-nbackup-(?:German|de)\.pdf$ /file/documentation/pdf/de/firebirddocs/nbackup/firebird-nbackup-de.pdf permanent;

  # generatorguide - Firebird Generator Guide
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/generatorguide.*$ /file/documentation/html/en/firebirddocs/generatorguide/firebird-generator-guide.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-Generator-Guide\.pdf$ /file/documentation/pdf/en/firebirddocs/generatorguide/firebird-generator-guide.pdf permanent;

  # generatorguide-de - Firebird Generator Guide German (Firebird Generatoren-Ratgeber)
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/de/generatorguide.*$ /file/documentation/html/de/firebirddocs/generatorguide/firebird-generatoren-ratgeber.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-Generator-Guide-German\.pdf$ /file/documentation/pdf/de/firebirddocs/generatorguide/firebird-generatoren-ratgeber.pdf permanent;

  # generatorguide-ru - Firebird Generator Guide Russian
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/ru/generatorguide.*$ /file/documentation/html/ru/firebirddocs/generatorguide/firebird-generator-guide-ru.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-Generator-Guide-Russian\.pdf$ /file/documentation/pdf/ru/firebirddocs/generatorguide/firebird-generator-guide-ru.pdf permanent;

  # nullguide - Firebird Null Guide
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/nullguide.*$ /file/documentation/html/en/firebirddocs/nullguide/firebird-null-guide.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-Null-Guide\.pdf$ /file/documentation/pdf/en/firebirddocs/nullguide/firebird-null-guide.pdf permanent;

  # fbmetasecur - Firebird File and Metadata Security
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/fbmetasecur.*$ /file/documentation/html/en/firebirddocs/fbmetasecur/firebird-metadata-security.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-File-Metadata-Security\.pdf$ /file/documentation/pdf/en/firebirddocs/fbmetasecur/firebird-metadata-security.pdf permanent;

  # fbmetasecur-pt_BR - Firebird File and Metadata Security Portuguese
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/pt_br/fbmetasecur.*$ /file/documentation/html/pt_BR/firebirddocs/fbmetasecur/firebird-metadata-security-pt_br.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-File-Metadata-Security-Brazilian-Portuguese\.pdf$ /file/documentation/pdf/pt_BR/firebirddocs/fbmetasecur/firebird-metadata-security-pt_br.pdf permanent;

  # fbmetasecur-ru - Firebird File and Metadata Security Russian
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/ru/fbmetasecur.*$ /file/documentation/html/ru/firebirddocs/fbmetasecur/firebird-metadata-security-ru.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-File-Metadata-Security-Russian\.pdf$ /file/documentation/pdf/ru/firebirddocs/fbmetasecur/firebird-metadata-security-ru.pdf permanent;

  # fbmetasecur-de - Firebird File and Metadata Security German
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/de/Firebird-File-Metadata-Security-German\.html$ /file/documentation/html/de/firebirddocs/fbmetasecur/firebird-metadata-security-de.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/de/Firebird-Sicherheit\.html$ /file/documentation/html/de/firebirddocs/fbmetasecur/firebird-metadata-security-de.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-File-Metadata-Security-German\.pdf$ /file/documentation/pdf/de/firebirddocs/fbmetasecur/firebird-metadata-security-de.pdf permanent;

  # firebirdinternals - Firebird Internals
  rewrite ^/file/documentation/reference_manuals/(?:reference_material|user_manuals)/html/fb-internals.*$ /file/documentation/html/en/firebirddocs/firebirdinternals/firebird-internals.html permanent;
  rewrite ^/file/documentation/reference_manuals/(?:reference_material|user_manuals)/html/fbint.*$ /file/documentation/html/en/firebirddocs/firebirdinternals/firebird-internals.html permanent;
  rewrite ^/file/documentation/reference_manuals/(?:reference_material|user_manuals)/html/bk0(?:2ar20apap|1ar21apar|2ar19apam|2ar21apar|3ar02apc)\.html$ /file/documentation/html/en/firebirddocs/firebirdinternals/firebird-internals.html#fbint-fbdump permanent;
  rewrite ^/file/documentation/reference_manuals/(?:reference_material|user_manuals)/(?i)Firebird-Internals\.pdf$ /file/documentation/pdf/en/firebirddocs/firebirdinternals/firebird-internals.pdf permanent;

  # fbodbc20 - Firebird ODBC/JDBC Driver 2.0 Manual
  rewrite ^/file/documentation/reference_manuals/driver_manuals/odbc/html/fbodbc205.*$ /file/documentation/html/en/refdocs/fbodbc20/firebird-odbc-driver-20-manual.html permanent;
  rewrite ^/file/documentation/reference_manuals/driver_manuals/odbc/fbodbc205\.pdf$ /file/documentation/pdf/en/refdocs/fbodbc20/firebird-odbc-driver-20-manual.pdf permanent;

  # fbodbc20-de - Firebird ODBC/JDBC-Treiber-Handbuch
  rewrite ^/file/documentation/reference_manuals/driver_manuals/odbc/html/de/fbodbc205.*$ /file/documentation/html/de/refdocs/fbodbc20/firebird-odbc-treiber-20-handbuch.html permanent;
  rewrite ^/file/documentation/reference_manuals/driver_manuals/odbc/fbodbc205-de\.pdf$ /file/documentation/pdf/de/refdocs/fbodbc20/firebird-odbc-treiber-20-handbuch.pdf permanent;

  # pdl - Public Documentation License
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/licenses-pdl.*$ /docs/html/en/licenses/pdl/public-documentation-license.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/pdl\.html$ /docs/html/en/licenses/pdl/public-documentation-license.html permanent;
  rewrite ^/file/documentation/reference_manuals/firebird_licenses/(?i)Public-Documentation-License\.pdf$ /docs/pdf/en/licenses/pdl/public-documentation-license.pdf permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/pdl\.pdf$ /docs/pdf/en/licenses/pdl/public-documentation-license.pdf permanent;

  # ufb - Using Firebird
  rewrite ^/file/documentation/reference_manuals/user_manuals/html/ufb.*$ /file/documentation/html/en/firebirddocs/ufb/using-firebird.html permanent;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Using-Firebird_\(wip\)\.pdf$ /file/documentation/pdf/en/firebirddocs/ufb/using-firebird.pdf permanent;

  # Incomplete or broken links
  rewrite ^/file/documentation/reference_manuals/(reference_material|user_manuals)/pdf/(.*)$ /file/documentation/reference_manuals/$1/$2;
  rewrite ^/file/documentation/reference_manuals/user_manuals/(?i)Firebird-2\.0-QuickStart\.pdf$ /file/documentation/reference_manuals/user_manuals/Firebird-2-QuickStart.pdf permanent;
  rewrite ^/file/documentation/reference_manuals/(?:reference_material|user_manuals)(?:/(?:pdf|html))?/?$ /en/reference-manuals/ redirect;
}
location = /file/documentation/reference_manuals {
  return 302 /en/reference-manuals/ redirect;
}

# Release notes
location /file/documentation/release_notes/ {
  # Firebird 2.5 release notes
  rewrite ^/file/documentation/release_notes/html/((?:rlsnotes25|rnfb25-[^.]*)\.html)$ /file/documentation/release_notes/html/en/2_5/rlsnotes25.html permanent;

  # Firebird 3.0 release notes
  rewrite ^/file/documentation/release_notes/html/en/3_0/rnfb3.*$ /file/documentation/release_notes/html/en/3_0/rlsnotes30.html permanent;
  rewrite ^/file/documentation/release_notes/html/en/3_0/bk.*$ /file/documentation/release_notes/html/en/3_0/rlsnotes30.html permanent;
  rewrite ^/file/documentation/release_notes/html/en/3_0/bug.*$ /file/documentation/release_notes/html/en/3_0/rlsnotes30.html permanent;
  rewrite ^/file/documentation/release_notes/html/rlsnotes30(?:mono)?\.html /file/documentation/release_notes/html/en/3_0/rlsnotes30.html permanent;

  # Incomplete or broken links
  rewrite ^/file/documentation/release_notes/html/en/2_5/?$ /file/documentation/release_notes/html/en/2_5/rlsnotes25.html redirect;
  rewrite ^/file/documentation/release_notes/html/en/3_0/?$ /file/documentation/release_notes/html/en/3_0/rlsnotes30.html redirect;
  rewrite ^/file/documentation/release_notes/html/en/?$ /en/release-notes/ redirect;
  rewrite ^/file/documentation/release_notes/html/rlsnotes21\.html$ /file/documentation/release_notes/html/rlsnotes217.html redirect;
  rewrite ^/file/documentation/release_notes/Firebird-2\.0\.[0-5]\.pdf /file/documentation/release_notes/Firebird-2.0.7-ReleaseNotes.pdf redirect;
}

location /file/documentation/drivers_documentation {
  # Jaybird documentation
  rewrite ^/file/documentation/drivers_documentation/java/([2-5]\.\d)\.\d+[^/]*/(.*)$ /docs/drivers/java/$1.x/$2 redirect;
  rewrite ^/file/documentation/drivers_documentation/java/manual-SNAPSHOT/jaybird_manual\.html$ https://firebirdsql.github.io/jaybird-manual/jaybird_manual.html permanent;

  # Incomplete or broken links
  rewrite ^/file/documentation/drivers_documentation/java/?$ /en/jdbc-driver/ redirect;
  rewrite ^/file/documentation/drivers_documentation/?$ /en/drivers-documentation/ redirect;
}

# Asciidoc HTML (should be used for fixes only)
location /file/documentation/html {
  # fbcache - Fix old incorrect links
  rewrite ^/file/documentation/html/en/firebirddocs/firebird-fbcache\.html$ /file/documentation/html/en/firebirddocs/fbcache/firebird-cache.html permanent;
  rewrite ^/file/documentation/html/en/firebirddocs/firebird-cache\.html$ /file/documentation/html/en/firebirddocs/firebird/fbcache/firebird-cache.html permanent;

  # fbcache de - Fix old incorrect links
  rewrite ^/file/documentation/html/de/firebirddocs/firebird-fbcache-de\.html$ /file/documentation/html/de/firebirddocs/fbcache/firebird-cache-de.html permanent;
  rewrite ^/file/documentation/html/de/firebirddocs/firebird-cache-de\.html$ /file/documentation/html/de/firebirddocs/fbcache/firebird-cache-de.html permanent;

  # SEO for incomplete links
  rewrite ^/file/documentation/html/?$ /en/documentation/ redirect;
}

# Asciidoc PDF (should be used for fixes only)
location /file/documentation/pdf {
  # fbcache - Fix old incorrect links
  rewrite ^/file/documentation/pdf/en/firebirddocs/firebird-fbcache\.pdf$ /file/documentation/html/en/firebirddocs/fbcache/firebird-cache.pdf permanent;
  rewrite ^/file/documentation/pdf/en/firebirddocs/firebird-cache\.pdf$ /file/documentation/pdf/en/firebirddocs/fbcache/firebird-cache.pdf permanent;

  # fbcache de - Fix old incorrect links
  rewrite ^/file/documentation/pdf/de/firebirddocs/firebird-fbcache-de\.pdf$ /file/documentation/html/de/firebirddocs/fbcache/firebird-cache-de.pdf permanent;
  rewrite ^/file/documentation/html/de/firebirddocs/firebird-cache-de\.pdf$ /file/documentation/html/de/firebirddocs/fbcache/irebird-cache-de.pdf permanent;

  # fbmetasecur-de - fixup incorrect initial urls:
  rewrite ^/file/documentation/html/de/firebirddocs/fbmetadatasecur/firebird-metadata-security-de\.html$ /file/documentation/html/de/firebirddocs/fbmetasecur/firebird-metadata-security-de.html permanent;

  # fbmetasecur-de - fixup incorrect initial urls:
  rewrite ^/file/documentation/pdf/de/firebirddocs/fbmetadatasecur/firebird-metadata-security-de\.pdf$ /file/documentation/pdf/de/firebirddocs/fbmetasecur/firebird-metadata-security-de.pdf permanent;

  # SEO for incomplete links
  rewrite ^/file/documentation/pdf/?$ /en/documentation/ redirect;
}

# Installer after-install redirect
location /afterinstall {
  # Unclear where $lng is defined, may need to be verified
  if ($lng ~ "en|ru|br") {
    rewrite ^/afterinstall/?$ /afterinstall-$lng/? permanent;
  }
}

# Old site request param mapping
location ~* /index.php$ {
  # NOTE: Commented out rules are usually covered by another broader rule
  if ($arg_op = "events") { return 301 /en/news/; }
  if ($arg_id = "newsarchive") { return 301 /en/news/; }
  if ($arg_op = "newsportal") { return 301 /en/news/; }

  if ($args = "lists") { return 301 /en/mailing-lists/; }
  if ($arg_op = "lists") { return 301 /en/mailing-lists/; }
  if ($args = "op=&op=lists") { return 301 /en/mailing-lists/; }

  if ($arg_id = "about-firebird") { return 301 /en/about-firebird/; }

  #if ($args = "op=files&id=engine") { return 301 /en/downloads/; }
  if ($arg_id ~ "^engine_10\d$") { return 301 /en/firebird-1-0/; }
  if ($arg_id ~ "^engine_15\d$") { return 301 /en/firebird-1-5/; }
  if ($arg_id ~ "^fb15\d_.*"){ return 301 /en/firebird-1-5/; }
  if ($arg_id ~ "^engine_20\d$") { return 301 /en/firebird-2-0/; }
  if ($arg_id ~ "^fb2_.*$") { return 301 /en/firebird-2-0/; }
  if ($arg_id ~ "^fb20\d?_.*$") { return 301 /en/firebird-2-0/; }
  if ($arg_id ~ "^engine_21\d$") { return 301 /en/firebird-2-1/; }
  if ($arg_id ~ "^fb21\d_.*$") { return 301 /en/firebird-2-1/; }
  if ($arg_id ~ "^engine_25\d$") { return 301 /en/firebird-2-5/; }
  if ($arg_id ~ "^fb25\d?(?:_.*)?$"){ return 301 /en/firebird-2-5/; }
  if ($args = "op=files&id=netprovider") { return 301 /en/net-provider/; }
  if ($args = "op=files&id=odbc") { return 301 /en/odbc-driver/; }
  if ($args = "op=files&id=jaybird") { return 301 /en/jdbc-driver/; }
  if ($arg_id = "snapshots") { return 301 /en/snapshot-builds/; }
  if ($arg_id = "sphinx") { return 301 /en/sphinx-full-text-search/; }
  if ($arg_op = "files") { return 301 /en/downloads/; }

  if ($args = "doc") { return 301 /en/documentation/; }
  #if ($arg = "op=doc&id=userdoc") { return 301 /en/documentation/; }
  if ($arg_id = "othersites") { return 301 /en/external-documentation/; }
  if ($arg_id = "idpl"){ return 301 /en/initial-developer-s-public-license-version-1-0/; }
  if ($arg_id = "ipl"){ return 301 /en/interbase-public-license/; }
  if ($args = "op=doc&sub=contrib&id=connect_to_linux"){ return 301 /en/connecting-to-firebird-1-5-on-linux/; }
  if ($args = "op=doc&id=fb_1_5_charsets") { return 301 /en/firebird-1-5-character-sets-collations/; }
  if ($arg_op = "doc") { return 301 /en/documentation/; }

  if ($args = "op=guide&id=techspec") { return 301 /en/firebird-technical-specifications/; }
  #if ($args = "op=guide&id=ib6_newfeatures") { return 301 /en/documentation/; }
  #if ($args = "op=guide&id=upgrading"){ return 301 /en/documentation/; }
  if ($args = "op=guide&id=whichKit"){ return 301 /en/downloads/; }
  if ($args = "op=guide&id=links"){ return 301 /en/external-documentation/; }
  if ($arg_op = "guide") { return 301 /en/documentation/; }

  if ($arg_op = "faq.html") { return 301 /en/faq/; }
  if ($arg_op = "faq") { return 301 /en/faq/; }

  #if ($args = "op=useful&id=ostenried_1") { return 301 /en/third-party-docs-and-articles/; }
  if ($args = "op=useful&id=deatz_udf") { return 301 /en/writing-udfs-for-interbase/; }
  #if ($args = "op=useful&id=geldenhuis") { return 301 /en/third-party-docs-and-articles/; }
  #if ($args = "op=useful&id=netzka") { return 301 /en/third-party-docs-and-articles/; }
  #if ($args = "op=useful&id=Connectivity") { return 301 /en/third-party-docs-and-articles/; }
  #if ($args = "op=useful&id=Connectivity&nosb=1") { return 301 /en/third-party-docs-and-articles/; }
  if ($args = "op=useful&id=calford_1") { return 301 /en/some-solutions-to-old-problems/; }
  if ($args = "op=useful&id=zamana"){ return 301 /en/how-we-installed-interbase-6-on-red-hat-6-2-7/; }
  if ($arg_op = "useful") { return 301 /en/third-party-docs-and-articles/; }

  #if ($args = "op=devel&sub=engine") { return 301 /en/development/; }
  #if ($args = "op=devel&sub=engine&id=development") { return 301 /en/development/; }
  if ($arg_id = "roadmap") { return 301 /en/roadmap/; }
  if ($arg_id = "SQL_conformance") { return 301 /en/sql-conformance/; }
  if ($args = "op=devel&sub=engine&id=rnotes0152_09") { return 301 /file/documentation/release_notes/html/rlsnotes15.html; }
  if ($args = "op=devel&sub=engine&id=rnotes0152_09&nosb=1") { return 301 /file/documentation/release_notes/html/rlsnotes15.html; }
  #if ($args = "op=devel&sub=engine&id=develff201012") { return 301 /en/development/; }
  #if ($args = "op=devel&sub=engine&id=dsqlff200805") { return 301 /en/development/; }
  if ($args = "op=devel&sub=engine&id=nbackup") { return 301 /en/documentation/; }
  #if ($args = "op=devel&sub=qa") { return 301 /en/devel-qa/; }
  #if ($args = "op=devel&sub=qa&id=qmtest_howto") { return 301 /en/devel-qa/; }
  if ($args = "op=devel&sub=qa&id=bugreport_howto") { rewrite 301 /en/issue-tracker/; }
  #if ($args = "op=devel&sub=qa&id=methods") { return 301 /en/devel-qa/; }
  if ($arg_sub = "qa") { return 301 /en/devel-qa/; }
  if ($args = "op=devel&sub=doc") { return 301 /en/devel-docs/; }
  if ($args = "op=devel&sub=techdoc") { return 301 /en/documentation/; }
  if ($args = "op=devel&sub=netprovider") { return 301 /en/devel-net-provider/; }
  if ($args = "op=devel&sub=netprovider&id=development") { return 301 /en/devel-net-provider/; }
  if ($args = "op=devel&sub=netprovider&id=examples") { return 301 /en/net-examples-of-use/; }
  if ($args = "op=devel&sub=netprovider&id=tools") { return 301 /en/net-provider/; }
  if ($args = "op=devel&sub=netprovider&id=faq") { return 301 /en/drivers-documentation/; }
  if ($args = "op=devel&sub=netprovider&id=dotnetff200409") { return 301 /en/devel-net-provider/; }
  if ($args = "op=devel&sub=netprovider&id=dotnetff201012") { return 301 /en/devel-net-provider/; }
  if ($args = "op=devel&sub=netprovider&id=features"){ return 301 /en/devel-net-provider/; }
  if ($args = "op=devel&sub=netprovider&id=links"){ return 301 /en/devel-net-provider/; }
  if ($args = "op=devel&sub=odbc") { return 301 /en/devel-odbc-driver/; }
  if ($args = "op=devel&sub=odbc&id=odbcff201012") { return 301 /en/devel-odbc-driver/; }
  if ($args = "op=devel&sub=jdbc") { return 301 /en/devel-jdbc-driver/; }
  if ($args = "op=devel&sub=jdbc&id=aboutjbird") { return 301 /en/devel-jdbc-driver/; }
  if ($args = "op=devel&sub=jdbc&id=faq") { return 301 /docs/drivers/java/faq.html; }
  if ($args = "op=devel&sub=python") { return 301 /en/devel-python-driver/; }
  if ($args = "op=devel&sub=python&id=pytools") { return 301 /en/python-driver/; }
  if ($args = "op=devel&id=bugdb") { return 301 /en/issue-tracker/; }
  #if ($args = "op=devel&sub=plugins"){ return 301 /en/development/; }
  if ($args = "op=devel&sub=plugins&id=external_java"){ return 301 https://github.com/FirebirdSQL/fbjava; }
  if ($args = "op=devel&sub=web"){ return 301 /en/contact-us/; }
  if ($args = "op=devel&sub=web&id=webtools"){ return 301 /; }
  #if ($args = "op=devel&sub=porting"){ return 301 /en/development/; }
  if ($args = "op=devel&sub=interclient") { return 301 /en/jdbc-driver/; }
  #if ($args = "op=devel&id=cvs_howto") { return 301 /en/development/; }
  if ($arg_op = "devel") { return 301 /en/development/; }

  if ($arg_id = "contributions") { return 301 /en/donate/; }
  if ($args = "op=ffoundation&sub=connect") { return 301 /en/white-papers-presentations/; }
  if ($arg_id = "firebirdbrandfaq") { return 301 /en/firebird-brand-faq/; }
  #if ($args = "op=ffoundation&id=members") { return 301 /en/firebird-foundation/; }
  if ($arg_id = "firebird-logo") { return 301 /en/logos/; }
  if ($arg_id = "gloat_logos") { return 301 /en/logos/; }
  if ($arg_id = "support_logos") { return 301 /en/logos/; }
  if ($args = "op=ffoundation&sub=ffblog") { return 301 /en/news/; }
  if ($args = "op=ffoundation&id=sponsorship") { return 301 /en/sponsors/; }
  if ($args = "op=ffoundation&id=resourcedonors") { return 301 /en/sponsors/; }
  if ($args = "op=ffoundation&id=sponsor_howto") { return 301 /en/how-to-become-a-sponsor/; }
  if ($args = "op=ffoundation&id=techsupport") { return 301 /en/support/; }
  #if ($args ~ "^op=ffoundation&id=main_.*$") { return 301 /en/firebird-foundation/; }
  #if ($args = "op=ffoundation&id=aboutMembership") { return 301 /en/firebird-foundation/; }
  if ($args = "op=ffoundation&sub=docs") { return 301 /en/public-reports-documents/; }
  #if ($args = "op=ffoundation&sub=docs&id=certificate") { return 301 /en/firebird-foundation/; }
  if ($args = "op=ffoundation&sub=docs&id=rules") { return 301 /en/articles-of-association/; }
  #if ($args = "op=ffoundation&id=members_alpha") { return 301 /en/firebird-foundation/; }
  #if ($args = "op=ffoundation&sub=committee&id=agenda") { return 301 /en/firebird-foundation/; }
  #if ($args = "op=ffoundation&id=payYourMembership") { return 301 /en/firebird-foundation/; }
  if ($args = "op=ffoundation&id=ideas") { return 301 /en/contact-us/; }
  if ($arg_op = "ffoundation") { return 301 /en/firebird-foundation/; }

  #if ($args = "op=history&id=firebird") { return 301 /en/historical-reference/; }
  #if ($args = "op=history&id=beginning") { return 301 /en/historical-reference/; }
  #if ($args = "op=history&id=opensource") { return 301 /en/historical-reference/; }
  #if ($args = "op=history&id=whoiswho") { return 301 /en/historical-reference/; }
  #if ($args = "op=history&id=borland") { return 301 /en/historical-reference/; }
  if ($arg_op = "history") { return 301 /en/historical-reference/; }

  if ($arg_op = "umbrella") { return 301 /en/community/; }

  if ($arg_op = "contact") { return 301 /en/contact-us/; }

  if ($args = "") { return 301 /; }

  # Go to site map otherwise
  return 302 /en/map/;
}

location / {
  if ($arg_id = "idpl"){ return 301 /en/initial-developer-s-public-license-version-1-0/; }
  if ($arg_id = "ipl"){ return 301 /en/interbase-public-license/; }
  if ($arg_id = "netprovider") { return 301 /en/net-provider/; }
  if ($arg_id = "netprovider") { return 301 /en/net-provider/; }
  if ($arg_op = "files") { return 301 /en/downloads/; }
  if ($arg_op = "lists") { return 301 /en/mailing-lists/; }
  if ($arg_op = "faq.html") { return 301 /en/faq/; }
  if ($arg_op = "faq") { return 301 /en/faq/; }
  if ($arg_op = "doc") { return 301 /en/documentation/; }
  if ($args = "op=devel&sub=doc") { return 301 /en/devel-docs/; }
  if ($arg_op = "devel") { return 301 /en/development/; }
  if ($arg_id = "othersites") { return 301 /en/external-documentation/; }
  if ($arg_op = "contact") { return 301 /en/contact-us/; }
  if ($arg_id = "contributions.html")  { return 301 /en/donate/; }
  if ($arg_id = "contributions")  { return 301 /en/donate/; }
  if ($arg_op = "ffoundation") { return 301 /en/firebird-foundation/; }
}

# Incomplete or broken link redirects (SEO)
rewrite ^/doc/whitepapers/events_paper\.pdf$ /file/documentation/papers_presentations/Power_Firebird_events.pdf permanent;
rewrite ^/file/documentation/chunk/en/refdocs/?$ /en/reference-manuals/ redirect;
rewrite ^/file/?$ / redirect;

# Renamed or removed pages
rewrite ^/en/development-documentation/?$ /en/devel-docs/ permanent;
rewrite ^/en/firebird-2-0-\d[^/]*/?$ /en/firebird-2-0/ redirect;
rewrite ^/en/firebird-2-1-\d[^/]*/?$ /en/firebird-2-1/ redirect;
rewrite ^/en/firebird-3-0-0-(?:rc|alpha|beta)\d/?$ /en/firebird-3-0/ redirect;
rewrite ^/en/firebird-4-0-0-(?:rc|alpha|beta)\d/?$ /en/firebird-4-0/ redirect;
rewrite ^/en/firebird-5-0-0-(?:rc|alpha|beta)\d/?$ /en/firebird-5-0/ redirect;
rewrite ^/en/development-mailing-lists/?$ /en/devel-mailing-lists/ permanent;
rewrite ^/en/jdbc-devel-status/?$ /en/devel-jdbc-driver/ permanent;
rewrite ^/en/jaybird-faq/?$ /docs/drivers/java/faq.html permanent;
rewrite ^/en/development-net-provider/?$ /en/devel-net-provider/ permanent;
rewrite ^/en/development-jdbc-driver/?$ /en/devel-jdbc-driver/ permanent;
rewrite ^/en/development-odbc-driver/?$ /en/devel-odbc-driver/ permanent;
rewrite ^/en/development-python-driver/?$ /en/python-driver/ permanent;
rewrite ^/en/quality-assurance/?$ /en/devel-qa/ permanent;
rewrite ^/en/feature-matrix/?$ /en/firebird-technical-specifications/ permanent;
rewrite ^/en/download/?$ /en/downloads/ redirect;
rewrite ^/en/download/drivers/?$ /en/connectivity/ redirect;
rewrite ^/en/members/?$ /en/firebird-foundation/ redirect;
rewrite ^/en/membership/?$ /en/firebird-foundation/ redirect
rewrite ^/en/certificate/?$ /en/firebird-foundation/ redirect;
rewrite ^/en/portability-notes/?$ /en/development/ redirect;
rewrite ^/en/?$ / redirect;
rewrite ^/en/about/?$ /en/about-firebird/ redirect;
rewrite ^/foundation/?$ /en/firebird-foundation/ redirect;

# Licenses
rewrite ^/ipl/?$ /en/interbase-public-license/ redirect;
rewrite ^/idpl/?$ /en/initial-developer-s-public-license-version-1-0/ redirect;

# End of redirect configuration for www.firebirdsql.org
